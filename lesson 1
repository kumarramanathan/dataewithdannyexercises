
What was the first item from the menu purchased by each customer?

SET search_path = dannys_diner;

with cte as (
select customer_id , product_id , dense_rank() over (partition by customer_id order by order_date) as rank_details , row_number() over (partition by customer_id order by order_date) as RN from sales
)
select a.customer_id , m.product_name from cte a join menu m on m.product_id = a.product_id where a.rank_details = 1 and a.RN = 1 ;

Output:
======
customer_id	product_name
A	sushi
B	curry
C	ramen

What is the most purchased item on the menu and how many times was it purchased by all customers?
